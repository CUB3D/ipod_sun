pub trait ExploitConfig {
    /// This offset will write to the buildchar len
    const OFFSET_BUILDCHAR_LEN_PTR: u16;

    /// This offset will write to the buildchar ptr itself
    const OFFSET_BUILDCHAR_PTR: u16;

    /// This offset will write to LR
    /// In n5g emu this should be 23
    const OFFSET_LR: u16;

    /// Number of elements to push onto the CFF stack before swapping
    const PUSH_COUNT: usize;

    /// Number of pointer swaps to do to overwrite buildchar
    const SWAP_COUNT: usize;

    /// How many times to drop back down
    const DROP_COUNT: usize;
}

pub struct ExploitConfigN6G;
impl ExploitConfig for ExploitConfigN6G {
    const OFFSET_BUILDCHAR_LEN_PTR: u16 = 120;
    const OFFSET_BUILDCHAR_PTR: u16 = Self::OFFSET_BUILDCHAR_LEN_PTR - 1;
    const OFFSET_LR: u16 = Self::OFFSET_BUILDCHAR_LEN_PTR + 24;
    const PUSH_COUNT: usize = 43;
    const SWAP_COUNT: usize = 128;
    const DROP_COUNT: usize = Self::SWAP_COUNT + 17;
}

pub struct ExploitConfigN5GEmu;
impl ExploitConfig for ExploitConfigN5GEmu {
    const OFFSET_BUILDCHAR_LEN_PTR: u16 = 120;
    const OFFSET_BUILDCHAR_PTR: u16 = Self::OFFSET_BUILDCHAR_LEN_PTR - 1;
    const OFFSET_LR: u16 = Self::OFFSET_BUILDCHAR_LEN_PTR + 23;
    const PUSH_COUNT: usize = 43;
    const SWAP_COUNT: usize = 128;
    const DROP_COUNT: usize = Self::SWAP_COUNT + 17;
}
